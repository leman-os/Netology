# Домашнее задание к занятию "3.7. Компьютерные сети, лекция 2"

1. Проверьте список доступных сетевых интерфейсов на вашем компьютере. Какие команды есть для этого в Linux и в Windows?

   **Ответ:**

   ```bash
   vagrant@vagrant:~$ ip -br link
   lo               UNKNOWN        00:00:00:00:00:00 <LOOPBACK,UP,LOWER_UP> 
   eth0             UP             08:00:27:b1:28:5d <BROADCAST,MULTICAST,UP,LOWER_UP> 
   
   [4]+  Stopped                 man ip
   vagrant@vagrant:~$ ip addr
   1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
       link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
       inet 127.0.0.1/8 scope host lo
          valid_lft forever preferred_lft forever
       inet6 ::1/128 scope host 
          valid_lft forever preferred_lft forever
   2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000
       link/ether 08:00:27:b1:28:5d brd ff:ff:ff:ff:ff:ff
       inet 10.0.2.15/24 brd 10.0.2.255 scope global dynamic eth0
          valid_lft 65327sec preferred_lft 65327sec
       inet6 fe80::a00:27ff:feb1:285d/64 scope link 
          valid_lft forever preferred_lft forever
   ```

   В Windows используется комманда 

   ```
   ipconfig /all
   ```

2. Какой протокол используется для распознавания соседа по сетевому интерфейсу? Какой пакет и команды есть в Linux для этого?

   **Ответ:**

   Для распознавания соседей используется протокол обмена информацией между соседними устройствами **LLDP**. Пакет комманд называется lldpd. 

   

3. Какая технология используется для разделения L2 коммутатора на несколько виртуальных сетей? Какой пакет и команды есть в Linux для этого? Приведите пример конфига.

   **Ответ:**

   Для виртуального разделения на несколько подсетей используется технология VLAN. 

   ```bash
   
   auto vlan777
   iface vlan777 inet static
           address 10.0.2.15
           netmask 255.255.255.0
           vlan_raw_device eth0
   ```

4. Какие типы агрегации интерфейсов есть в Linux? Какие опции есть для балансировки нагрузки? Приведите пример конфига.

   **Ответ:**

   Для агрегации портов используется технология LAG. В линуксе - это бондинг из пакета ifenslave. Бывает статический и динамический LAG. 

   Параметры настройки:

   - `	miimon` — определяет как часто производится мониторинг MII. `0` – мониторинг отключён (используется по-умолчанию). Рекомендуемое значение 100 мс.

   - `arp_interval` — с какой периодичностью в миллисекундах осуществлять ARP-мониторинг. Значение `0` — ARP-мониторинг выключен.

   - `arp_ip_target` — IP-адрес, по которому осуществлять ARP-мониторинг (в случае если значение `arp_interval` больше `0`). Если с данного адреса нет ARP-ответов, значит канал, по которому посылались запросы, не работает.

   - `downdelay` — задержка в миллисекундах с момента, как было обнаружено, что связь утеряна, до момента, как данный канал перестанет быть активным. Задержка нужна, чтобы отфильтровывать кратковременные сбои. Например, после переключения кабеля. По-умолчанию используется значение `0` – нет задержки.

   - `updelay` — то же самое, что и `downdelay`, но определяет задержку по включению. На случай, когда сетевой коммутатор (switch) или концентратор (hub) «не до конца включились», напряжение на порт подано, а пакеты не принимаются.

   - `max_bonds` — определяет количество bond-интерфейсов, которые будут созданы при загрузке одного модуля. Значение по-умолчанию — `1`.

   - `primary` — указывает подчинённый интерфейс (`eth0`, `eth1` и прочие), который будет основным в связке. Указанный интерфейс всегда будет работать в активном режиме, когда это возможно. Особенно актуально это, когда скорость одного интерфейса больше других. Опция primary доступна только для режима `active-backup`.

   - ` primary_reselect` — определяет условия выбора активного подчинённого интерфейса:

     - `always` или `0` — первичный подчинённый интерфейс всегда становится активным, когда это возможно;

     - `better` или `1` — интерфейс становится активным, если скорость и duplex-режим больше, чем скорость и дуплексный режим активного интерфейса;

     - `failure` или `2` — интерфейс становится активным лишь в случае, когда текущий активный интерфейс становится недоступным.

   ```bash
   
   auto bond0
   
   iface bond0 inet static
       address 10.31.1.5
       netmask 255.255.255.0
       network 10.31.1.0
       gateway 10.31.1.254
       bond-slaves eth0 eth1
       bond-mode active-backup
       bond-miimon 100
       bond-downdelay 200
       bond-updelay 200
   ```

5. Сколько IP адресов в сети с маской /29 ? Сколько /29 подсетей можно получить из сети с маской /24. Приведите несколько примеров /29 подсетей внутри сети 10.10.10.0/24.

   **Ответ:**

   В сети с маской /29 - 8 адресов. Из /24 сети можно получить 24 подсети /29. Не 32, потому как надо учитывать, что по 1 адресу уходит на широковещание и адрес сети.

   Примеры подсетей /29 внутри /24:

   - 10.10.10.1/29 (10.10.10.2-10.10.10.7), 10.10.10.1 - адрес сети, 10.10.10.9 - адрес broadcast.

   - 10.10.10.247/29 (10.10.10.248-10.10.10.253), 10.10.10.247 - адрес сети, 10.10.10.254 - адрес broadcast

     

6. Задача: вас попросили организовать стык между 2-мя организациями. Диапазоны 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16 уже заняты. Из какой подсети допустимо взять частные IP адреса? Маску выберите из расчета максимум 40-50 хостов внутри подсети.

   **Ответ:**

   Нужно взять подсеть из подсети Carrier-Grade NAT. Можно использовать маску 26 на 62 хоста (40-50 честно не знаю, как можно задать. Если только двумя подсетями).

   ```bash
   1. Requested size: 40 hosts
   Netmask:   255.255.255.192 = 26
   Network:   100.64.0.0/26
   HostMin:   100.64.0.1
   HostMax:   100.64.0.62
   Broadcast: 100.64.0.63
   Hosts/Net: 62
   ```

7. Как проверить ARP таблицу в Linux, Windows? Как очистить ARP кеш полностью? Как из ARP таблицы удалить только один нужный IP?

   **Ответ:**

   Для Windows:
   
   ```bash
   C:\Users\user>arp -a
   
   Интерфейс: 10.11.20.14 --- 0xf
     адрес в Интернете      Физический адрес      Тип
     10.11.20.254          02-04-96-d8-89-de     динамический
     10.11.20.255          ff-ff-ff-ff-ff-ff     статический
     224.0.0.22            01-00-5e-00-00-16     статический
     224.0.0.251           01-00-5e-00-00-fb     статический
     224.0.0.252           01-00-5e-00-00-fc     статический
     224.0.1.60            01-00-5e-00-01-3c     статический
     232.44.44.233         01-00-5e-2c-2c-e9     статический
     239.192.152.143       01-00-5e-40-98-8f     статический
     239.193.0.15          01-00-5e-41-00-0f     статический
     239.193.0.75          01-00-5e-41-00-4b     статический
     239.193.0.76          01-00-5e-41-00-4c     статический
     239.255.255.250       01-00-5e-7f-ff-fa     статический
     255.255.255.255       ff-ff-ff-ff-ff-ff     статический
   ```
   
   Для Linux:
   
   ```bash
   vagrant@vagrant:~$ ip neigh
   10.0.2.2 dev eth0 lladdr 52:54:00:12:35:02 REACHABLE
   10.0.2.3 dev eth0 lladdr 52:54:00:12:35:03 STALE
   ```
   
   Очистить кеш:
   
   - Linux: `ip neigh flush`
   - Windows: `arp -d *`
   
   Удалить один IP:
   
   - Linux: `ip neigh delete <IP> dev <INTERFACE>`, `arp -d <IP>`
   - Windows: `arp -d <IP>`
   
   

------



